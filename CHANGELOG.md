# 更新日志

本文档记录了 Hana LearnCode 项目的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [0.1.0] - 2024-12-14

### 🎉 首次发布

这是 Hana LearnCode 的首个版本，一个专门用于代码学习的 MCP 服务器。

### ✨ 新增功能

#### 核心模块

- **代码索引器 (CodeIndexer)**
  - 支持扫描多种编程语言的代码仓库
  - 自动提取函数、类、结构体定义
  - 智能忽略无关文件和目录（.git, __pycache__ 等）
  - 支持 C/C++, Python, Java, JavaScript 等语言
  - 提供函数和结构体搜索功能

- **代码分析器 (CodeAnalyzer)**
  - 追踪函数调用流程（支持可配置深度）
  - 分析特定概念相关的代码实现
  - 查找函数之间的调用路径（BFS 算法）
  - 提取完整的函数源代码
  - 分析函数复杂度（行数、控制结构、函数调用等）

- **流程图生成器 (FlowchartGenerator)**
  - 生成 Mermaid 格式的流程图
  - 支持多种图表类型：
    - 函数调用树图
    - 函数路径图
    - 概念关系图
    - 简单步骤流程图
    - 模块依赖图
    - 时序图

#### MCP 工具（8个）

1. `scan_code_repository` - 扫描并索引代码仓库
2. `search_functions` - 搜索包含关键字的函数
3. `trace_function_flow` - 追踪函数调用流程
4. `analyze_code_concept` - 分析特定概念相关的代码
5. `get_function_code` - 获取完整的函数源代码
6. `generate_flowchart` - 生成函数调用流程图
7. `generate_concept_flowchart` - 生成概念相关的流程图
8. `find_function_path` - 查找函数之间的调用路径

#### 文档

- **README.md** - 完整的项目说明文档
  - 功能特性介绍
  - 安装和配置指南
  - 所有工具的详细说明
  - 多个使用场景示例

- **QUICKSTART.md** - 快速开始指南
  - 5 分钟快速上手教程
  - Claude Desktop 配置说明
  - 第一个完整示例
  - 常见问题故障排除

- **USAGE_EXAMPLES.md** - 详细使用示例
  - 5 个真实场景的完整示例
  - 学习 Linux kernel 内存分配
  - 理解 Python Web 框架
  - 学习数据结构实现
  - 代码调试和路径追踪
  - 学习算法实现
  - 使用提示和技巧
  - 常见问题解答

- **PROJECT_SUMMARY.md** - 项目技术总结
  - 完整的技术架构说明
  - 核心类设计文档
  - 测试结果报告
  - 未来改进计划

- **CHANGELOG.md** - 更新日志（本文件）

#### 配置和测试

- **配置示例文件**
  - `claude_desktop_config_example.json` - 使用 uv 的配置
  - `claude_desktop_config_example_python.json` - 使用 Python 的配置

- **测试脚本**
  - `test_example.py` - 功能完整的测试脚本
    - 可独立运行，无需 MCP 客户端
    - 测试所有核心功能
    - 支持交互式测试自定义仓库
    - 美观的输出格式

### 🛠️ 技术实现

#### 代码解析

- 使用正则表达式进行代码解析
- 支持 C/C++ 和 Python 的函数、类提取
- 智能的括号匹配算法提取函数体
- 提取 include/import 依赖关系

#### 算法

- **DFS（深度优先搜索）** - 构建函数调用树
- **BFS（广度优先搜索）** - 查找函数调用路径
- **正则表达式匹配** - 提取代码结构
- **括号匹配算法** - 提取函数体

#### 性能优化

- 智能文件过滤机制
- 延迟加载文件内容
- 全局索引缓存
- 可配置的分析深度

### 📦 依赖项

```toml
requires-python = ">=3.13"
dependencies = [
    "mcp[cli]>=1.24.0",
    "tree-sitter>=0.23.2",
    "tree-sitter-c>=0.23.5",
    "tree-sitter-python>=0.23.6",
    "pygments>=2.18.0",
    "pathspec>=0.12.1",
]
```

### ✅ 测试

- 所有核心功能已测试并通过
- 无 Linter 错误
- 在实际项目上验证可用
- 测试结果：
  - ✓ 扫描 8 个 Python 文件
  - ✓ 索引 29 个函数，3 个类
  - ✓ 函数搜索正常
  - ✓ 流程追踪正常
  - ✓ 概念分析正常
  - ✓ 流程图生成正常
  - ✓ 代码提取正常

### 📝 代码质量

- 完整的类型提示
- 详细的文档字符串
- 清晰的代码结构
- 良好的错误处理
- 遵循 PEP 8 规范

### 🎯 支持的语言

| 语言 | 支持程度 | 功能 |
|------|---------|------|
| C/C++ | ⭐⭐⭐⭐ | 函数、结构体、include |
| Python | ⭐⭐⭐⭐ | 函数、类、import |
| Java | ⭐⭐⭐ | 基本支持 |
| JavaScript | ⭐⭐⭐ | 基本支持 |

### 📊 项目统计

- **总代码行数**: ~1500+ 行
- **核心模块**: 3 个
- **MCP 工具**: 8 个
- **文档页面**: 6 个
- **测试覆盖**: 所有核心功能

### 🚀 使用场景

1. **学习开源项目** - 理解大型代码库的工作原理
2. **项目代码理解** - 快速掌握新项目的代码结构
3. **代码调试** - 追踪函数调用链路
4. **算法学习** - 理解算法实现细节
5. **概念学习** - 深入学习特定主题的实现

---

## [未来计划]

### v0.2.0 - 计划中

#### 改进

- [ ] 集成 Tree-sitter 进行更准确的代码解析
- [ ] 支持更多编程语言（Go, Rust, Java）
- [ ] 添加增量索引功能
- [ ] 优化大型代码库的扫描性能
- [ ] 添加配置文件支持
- [ ] 改进错误消息和用户反馈

#### 新功能

- [ ] 代码复杂度详细分析
- [ ] 代码质量评分
- [ ] 变量和类型追踪
- [ ] 更多的流程图样式选项

### v0.3.0 - 规划中

#### 新功能

- [ ] 代码相似度检测
- [ ] 自定义代码模式搜索
- [ ] 生成代码文档
- [ ] 代码重构建议
- [ ] 代码注释生成

#### 改进

- [ ] Web UI 界面
- [ ] 交互式代码探索
- [ ] 持久化索引存储
- [ ] 多项目管理

### v1.0.0 - 长期目标

- [ ] AI 驱动的代码理解和解释
- [ ] 交互式代码探索界面
- [ ] 多项目联合分析
- [ ] 代码学习路径生成
- [ ] 知识图谱构建
- [ ] IDE 插件支持

---

## 贡献者

- **Hana** - 初始开发和实现

## 致谢

感谢以下开源项目：

- **FastMCP** - 优秀的 MCP 服务器框架
- **Mermaid** - 强大的图表生成工具
- **Claude AI** - 协助开发和测试

---

**注**: 版本号格式为 `主版本号.次版本号.修订号`
- **主版本号**: 不兼容的 API 变更
- **次版本号**: 向下兼容的功能性新增
- **修订号**: 向下兼容的问题修正

